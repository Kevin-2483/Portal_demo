# è§’è‰²äº’æ›é‚è¼¯åˆ†æ

## ğŸ¯ ç„¡æ„Ÿè§’è‰²äº’æ›çš„æ­£ç¢ºé‚è¼¯

### ç•¶å‰å•é¡Œåˆ†æ
æ ¹æ“šç”¨æˆ¶åé¥‹ï¼Œè§’è‰²äº’æ›æ‡‰è©²éµå¾ªä»¥ä¸‹é‚è¼¯ï¼š

#### âœ… æ­£ç¢ºçš„è§’è‰²äº’æ›é‚è¼¯ï¼š
```
è³ªå¿ƒç©¿è¶Šå‰ï¼š
ä¸»é«”(1001) - ä½ç½®Aï¼Œé€Ÿåº¦Vaï¼Œç‹€æ…‹Sa
å¹½éˆ(1002) - ä½ç½®Bï¼Œé€Ÿåº¦Vbï¼Œç‹€æ…‹Sb

è³ªå¿ƒç©¿è¶Šå¾Œï¼ˆè§’è‰²äº’æ›ï¼‰ï¼š
åŸå¹½éˆ(1002) â†’ è®Šæˆä¸»é«”ï¼Œä½†ä¿æŒåŸä½ç½®Bï¼Œé€Ÿåº¦Vbï¼Œç‹€æ…‹Sb
åŸä¸»é«”(1001) â†’ è®Šæˆå¹½éˆï¼Œä½†ä¿æŒåŸä½ç½®Aï¼Œé€Ÿåº¦Vaï¼Œç‹€æ…‹Sa
```

#### ğŸ”‘ é—œéµè¦é»ï¼š
1. **è§’è‰²é‚è¼¯æ”¹è®Š**ï¼šIDè·è²¬äº’æ›ï¼ˆèª°æ˜¯ä¸»æ§èª°æ˜¯åŒæ­¥ï¼‰
2. **ç‰©ç†ç‹€æ…‹ä¿æŒ**ï¼šå„è‡ªä¿æŒè‡ªå·±çš„é‹å‹•ç‹€æ…‹
3. **ç„¡æ„Ÿé«”é©—**ï¼šç©å®¶æ„Ÿå—ä¸åˆ°ä»»ä½•è·³èºæˆ–ä¸­æ–·

### ç•¶å‰ä»£ç¢¼æª¢æŸ¥

#### ç¾æœ‰å¯¦ç¾ï¼š
```cpp
bool success = physics_manipulator_->swap_entity_roles_with_faces(
    main_entity_id, ghost_entity_id, source_face, target_face);
```

#### å•é¡Œï¼š
- åªèª¿ç”¨äº†æ¥å£ï¼Œä½†æ²’æœ‰æ˜ç¢ºçš„ç‹€æ…‹ç¹¼æ‰¿é‚è¼¯
- ç¼ºå°‘è©³ç´°çš„å¯¦ç¾èªªæ˜
- ä¸ç¢ºå®šæ˜¯å¦æ»¿è¶³"ç‹€æ…‹ä¿æŒï¼Œè§’è‰²äº’æ›"çš„éœ€æ±‚

### æ­£ç¢ºå¯¦ç¾æ‡‰è©²æ˜¯ï¼š

```cpp
bool execute_entity_role_swap(EntityId main_id, EntityId ghost_id) {
    // 1. ä¿å­˜ç•¶å‰ç‹€æ…‹
    Transform main_transform = get_entity_transform(main_id);
    PhysicsState main_physics = get_entity_physics_state(main_id);
    Transform ghost_transform = get_entity_transform(ghost_id);  
    PhysicsState ghost_physics = get_entity_physics_state(ghost_id);
    
    // 2. è§’è‰²é‚è¼¯äº’æ›ï¼ˆé‡è¦ï¼šIDè·è²¬äº’æ›ï¼Œä¸æ˜¯ç‹€æ…‹äº’æ›ï¼‰
    // - åŸä¸»é«”è®Šæˆå¹½éˆï¼Œä½†ä¿æŒä½ç½®Aå’Œç‹€æ…‹Sa
    // - åŸå¹½éˆè®Šæˆä¸»é«”ï¼Œä½†ä¿æŒä½ç½®Bå’Œç‹€æ…‹Sb
    
    // 3. æ›´æ–°ç³»çµ±æ˜ å°„ï¼ˆé‚è¼¯è§’è‰²æ”¹è®Šï¼‰
    update_entity_role_mapping(main_id, ghost_id);
    
    // 4. ç¢ºä¿ç‰©ç†ç‹€æ…‹ä¸è®Šï¼ˆé€™æ˜¯ç„¡æ„Ÿçš„é—œéµï¼‰
    // ä¸éœ€è¦äº¤æ›ç‰©ç†ç‹€æ…‹ï¼Œå„è‡ªä¿æŒåŸç‹€æ…‹
    
    return true;
}
```

## ğŸš¨ éœ€è¦ä¿®æ­£çš„åœ°æ–¹

ç•¶å‰å¯¦ç¾å¯èƒ½å­˜åœ¨ç‹€æ…‹äº¤æ›ï¼Œé€™æœƒå°è‡´è¦–è¦ºè·³èºã€‚
æ­£ç¢ºçš„å¯¦ç¾æ‡‰è©²æ˜¯ï¼š
- âœ… è§’è‰²é‚è¼¯äº’æ›
- âœ… ç‰©ç†ç‹€æ…‹ä¿æŒ
- âœ… æ˜ å°„é—œä¿‚æ›´æ–°
- âŒ é¿å…ç‹€æ…‹äº¤æ›
